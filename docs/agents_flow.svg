<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800" viewBox="0 0 1200 800">
  <style>
    .box { fill:#f0f4ff; stroke:#334155; stroke-width:2px; rx:8; }
    .box2 { fill:#e6fff0; stroke:#14532d; stroke-width:2px; rx:8; }
    .box3 { fill:#fff7cc; stroke:#664d03; stroke-width:2px; rx:8; }
    .box4 { fill:#ffe6ee; stroke:#7f1d1d; stroke-width:2px; rx:8; }
    .text { font-family: Arial, Helvetica, sans-serif; font-size:14px; fill:#0f172a; }
    .title { font-weight:700; font-size:16px; }
    .arrow { stroke:#0f172a; stroke-width:2; fill:none; marker-end:url(#arrowhead); }
    .data-arrow { stroke:#14532d; stroke-width:2; fill:none; marker-end:url(#arrowhead); }
    .memory-arrow { stroke:#7f1d1d; stroke-width:2; fill:none; marker-end:url(#arrowhead); }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0f172a" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="40" y="30" class="text title">Agents flow â€” NLP Multi-Agent System</text>

  <!-- User Query -->
  <rect x="480" y="50" width="220" height="60" class="box"/>
  <text x="590" y="85" text-anchor="middle" class="text">User query</text>
  <text x="590" y="102" text-anchor="middle" class="text">(text)</text>

  <!-- Ticker Finder -->
  <rect x="200" y="150" width="240" height="60" class="box2"/>
  <text x="320" y="180" text-anchor="middle" class="text">src/utils/ticker_finder.py</text>
  <text x="320" y="197" text-anchor="middle" class="text">(discover tickers)</text>

  <!-- Memory -->
  <rect x="750" y="150" width="240" height="60" class="box4"/>
  <text x="870" y="180" text-anchor="middle" class="text">memory/memory_agent.py</text>
  <text x="870" y="197" text-anchor="middle" class="text">(retrieve history)</text>

  <!-- News Retrieval -->
  <rect x="480" y="250" width="240" height="80" class="box2"/>
  <text x="600" y="285" text-anchor="middle" class="text">news_retrieval_agent.py</text>
  <text x="600" y="302" text-anchor="middle" class="text">(fetch news &amp; summaries)</text>

  <!-- Sentiment Analysis -->
  <rect x="480" y="370" width="240" height="60" class="box2"/>
  <text x="600" y="405" text-anchor="middle" class="text">sentiment_analysis_agent.py</text>
  <text x="600" y="422" text-anchor="middle" class="text">(analyze sentiment)</text>

  <!-- Topic Classifier -->
  <rect x="200" y="370" width="240" height="80" class="box"/>
  <text x="320" y="405" text-anchor="middle" class="text">topic_classifier_agent.py</text>
  <text x="320" y="422" text-anchor="middle" class="text">(classify -> topic_id)</text>

  <!-- Specialist Agent -->
  <rect x="480" y="470" width="280" height="110" class="box3"/>
  <text x="620" y="500" text-anchor="middle" class="text">specialist_agent.py</text>
  <text x="620" y="518" text-anchor="middle" class="text">(generate response)</text>
  <text x="620" y="536" text-anchor="middle" class="text">(uses topic, news, memory)</text>

  <!-- Evaluator -->
  <rect x="480" y="620" width="260" height="100" class="box3"/>
  <text x="610" y="655" text-anchor="middle" class="text">evaluator_optimizer_agent.py</text>
  <text x="610" y="673" text-anchor="middle" class="text">(eval: relevance, accuracy, clarity)</text>

  <!-- Pipeline -->
  <rect x="40" y="50" width="220" height="60" class="box"/>
  <text x="150" y="75" text-anchor="middle" class="text">src/main/pipeline.ipynb</text>
  <text x="150" y="92" text-anchor="middle" class="text">(orchestrates agents)</text>
  <text x="150" y="35" text-anchor="middle" class="text" font-style="italic">Interacts with all agents</text>

  <!-- Memory Storage -->
  <rect x="750" y="620" width="240" height="100" class="box4"/>
  <text x="870" y="655" text-anchor="middle" class="text">memory/memory_agent.py</text>
  <text x="870" y="673" text-anchor="middle" class="text">(store Q/A history)</text>

  <!-- Specialist Training -->
  <rect x="850" y="470" width="300" height="100" class="box3"/>
  <text x="1000" y="505" text-anchor="middle" class="text">specialist_agents_training.py</text>
  <text x="1000" y="523" text-anchor="middle" class="text">(fine-tune / retrain specialists)</text>

  <!-- Arrows following actual pipeline flow -->
  <!-- Query split to Ticker & Memory -->
  <path d="M590 110 L320 150" class="arrow"/>
  <path d="M590 110 L870 150" class="arrow"/>
  
  <!-- Ticker & Memory to News -->
  <path d="M320 210 L600 250" class="data-arrow"/>
  <path d="M870 210 L600 250" class="memory-arrow"/>
  
  <!-- News to Sentiment -->
  <path d="M600 330 L600 370" class="data-arrow"/>
  
  <!-- Query to Topic -->
  <path d="M590 110 L320 370" class="arrow"/>
  
  <!-- Topic & Sentiment to Specialist -->
  <path d="M320 450 L620 470" class="arrow"/>
  <path d="M600 430 L620 470" class="data-arrow"/>
  
  <!-- Training to Specialist -->
  <path d="M850 520 L760 520" class="arrow"/>
  
  <!-- Specialist to Evaluator -->
  <path d="M620 580 L610 620" class="arrow"/>
  
  <!-- Evaluator to Memory -->
  <path d="M610 720 L870 670" class="memory-arrow"/>

  <!-- Labels -->
  <text x="320" y="250" class="text">ticker -> news</text>
  <text x="870" y="250" class="text">history -> news</text>
  <text x="670" y="390" class="text">sentiment -> specialist</text>
  <text x="440" y="410" class="text">topic -> specialist</text>
  <text x="780" y="500" class="text">model updates</text>

  <!-- Footer note -->
  <text x="40" y="770" class="text">Generated diagram: components and interactions among agent files (SVG). Convert to PNG locally if needed.</text>
</svg>
